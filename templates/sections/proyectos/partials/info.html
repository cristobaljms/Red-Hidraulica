{% load staticfiles %} {% if proyecto%}

<div class="row">
    <div class="col-md-4">

        <h4>
            <b>Nombre: </b> {{proyecto.nombre}}</h4>
        <h4>
            <b>Material: </b> {{proyecto.material}}</h4>
        <h4>
            <b>Fluido: </b> {{proyecto.fluido}}</h4>
        <br>

        <a href="#" onclick="generarGrafo({{proyecto.id}})" class="btn btn-sm btn-danger" data-toggle="tooltip" data-placement="top">
            Generar grafo
        </a>
    </div>
    <div id="sample" class="col-md-8">
        <div id="mynetwork" style="border: solid 1px lightgray; width:600px; height:400px"></div>
    </div>
</div>
<script src="{% static 'admin/js/vis.min.js' %}"></script>

<script>
    function generarGrafo(pk) {
        request_url = '/proyecto/datos/' + pk
        $.ajax({
            url: request_url,
            success: function (data) {
                var nodes = []
                reservorios = data.reservorios
                reservorios.map((reservorio) => {
                    nodes.push({
                        id: reservorio.numero,
                        label: reservorio.numero
                    })
                })

                nodos = data.nodos;
                nodos.map((nodo) => {
                    nodes.push({
                        id: nodo.numero,
                        label: nodo.numero
                    })
                })

                var links = []
                tuberias = data.tuberias
                tuberias.map(nodo => {
                    links.push({
                        from: nodo.start,
                        to: nodo.end,
                        label: nodo.numero
                    })
                })

                var nodos = new vis.DataSet(nodes);

                var edges = new vis.DataSet(links);

                var container = document.getElementById('mynetwork');

                var data = {
                    nodes: nodos,
                    edges: edges
                };
                var options = {
                    edges: {

                        inheritColors: false
                    },
                    nodes: {
                        parseColor: false
                    }
                };

                var network = new vis.Network(container, data, options);

            }
        })
    }


</script> {% endif %}